{% extends 'base.html' %}

{% block title %}Админ | Система заказов{% endblock %}

{% block header %}Вход в админ-панель{% endblock %}

{% block content %}
<div class="login-form">
    <h2>Вход в админ-панель</h2>
    {% if error %}
    <div class="error">{{ error }}</div>
    {% endif %}
    <form id="adminLoginForm" method="post">
        <div class="form-group">
            <label for="password">Пароль:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <button type="submit" class="btn">Войти</button>
    </form>
</div>
{% endblock %}

{% block script %}
document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    var password = document.getElementById('password').value;
    var formData = new FormData();
    formData.append('password', password);
    
    fetch('/admin_login', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            window.location.href = data.redirect;
        } else {
            alert('Неверный пароль');
        }
    })
    .catch(error => {
        console.error('Ошибка:', error);
        alert('Произошла ошибка при входе');
    });
});
{% endblock %}
